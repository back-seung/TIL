# 인터넷 네트워크 정리

> 출처 : 김영한님의 "모든 개발자를 위한 HTTP 웹 기본 지식"



## 인터넷 통신

> 수많은 클라이언트 PC와 수많은 서버PC가 서로 정보를 통신할 때 거리에 상관없이 인터넷의 노드를 통해 통신하게 된다.



## IP(Internet Protocol)

> 지정한 IP주소에 데이터 전달을 하는 역할을 한다.
>
> 패킷이라는 통신 단위로 데이터를 전달한다.



### IP 패킷 정보

* Package + Bucket : 패킷!

> IP패킷에는 `출발지 IP`, `목적지 IP`, `전송데이터`를 가지고 있다.
>
> 클라이언트는 패킷에 저장된 값을 통해 목적지로 갈 수 있는 노드를 탐색하며 전달하게 된다.
>
> 서버도 마찬가지로 패킷에 저장된 값으로 목적지로 가는 노드를 탐색하여 데이터를 클라이언트에게 전달한다.

* 클라이언트와 서버가 서로 패킷을 전달할 때 거쳤던 노드들은 각자 다른 경로로 전달될 수도 있다.



### IP 프로토콜의 한계

* 비연결성
  * 패킷을 받을 대상이 없거나 대상이 서비스 불능 상태여도 확인하지 않고 패킷을 전송한다.
* 비신뢰성
  * 중간에 패킷이 사라질 수도 있다.
  * 패킷의 용량이 커질 때는 이를 나눠서 보내는데 서로 다른 노드를 탈 수 있기 때문에 서로 다르게 도착한 패킷이 최종적으로 순서대로 도착하지 않을 수도 있다.
* 프로그램 구분
  * 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상일 때 IP만으로는 구분하지 못한다.  



## TCP, UDP

> IP프로토콜의 한계를 극복하기 위함이다.



### 인터넷 프로토콜 스택의 4계층

| 애플리케이션 계층 - HTTP,FTP |
| ---------------------------- |
| **전송 계층 - TCP, UDP**     |
| **인터넷 계층 - IP**         |
| **네트워크 인터페이스 계층** |



### TCP/IP 패킷 정보

* IP패킷 안에 TCP에 관련된 정보가 들어간다.
* TCP 세그먼트에는 `출발지 PORT`, `목적지 PORT`, `전송 제어`, `순서`, `검증 정보` 등이 들어간다.
* PORT : 서버안에서 돌아가는 애플리케이션을 구분하는 것



> IP만으로 해결이 안됐던 것들이 TCP 세그먼트에 의해 해결이 된다.



### TCP 개념 및 특징

#### 개념

> TCP는 전송 제어 프로토콜(Transmission Control Protocol)이다.

#### 특징

* 연결지향 - TCP 3 way handshake(논리적인 연결)

  : 상대와 자신이 연결이 됐는지 확인한다.

  1. SYN : 접속을 요청한다.
  2. SYN + ACK : 요청을 수락함과 동시에 상대에게 다시 접속을 요청한다.
  3. ACK : 처음 요청을 한 서버도 요청을 수락한다.
  4. 데이터를 전송한다.

* 데이터 전달 보증

  : 패킷이 중간에 누락되는 것을 알 수 있다.

  1. 데이터를 전송한다.
  2. 전송을 받은 측에서 데이터를 잘 받았다는 메시지를 보낸다.

* 순서 보장

  : 패킷을 `1,2,3` 순서로 보낸다고 할 때, `1,3,2`의 순서로 도착했다면 2부터 다시 보내 `1,2,3`의 순서를 보장한다.

#### 그렇기 때문에 TCP는

* 신뢰할 수 있는 프로토콜이다. 따라서 현재 대부분은 TCP를 사용한다.



### UDP

> 사용자 데이터그램 프로토콜(User Datagram Protocol)

#### 특징

* 기능이 거의 없다.
* 연결지향인 TCP 3 way handshake가 없다.

* 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠르다.

* **Port**와 **체크섬**(메시지가 맞는지 검증)만 추가 됐다고 생각하면 된다.
* 애플리케이션에서 추가 작업이 필요하다.



## PORT

> 한 번에 둘 이상의 다양한 패킷을 연결할 때 사용



### PORT가 담긴 TCP/IP 패킷 정보

* TCP 세그먼트안에는 출발지 IP, 목적지 IP와 더불어 출발지 PORT, 목적지 PORT가 함께 있다.
* IP : 목적지인 서버를 찾는 것.
* PORT : 서버안에서 돌아가는 애플리케이션을 구분하는 것



### PORT의 주요 목적

> 같은 IP 내에서 프로세스를 구분한다.



### PORT의 범위와 특징

* 포트는 0 ~ 65535까지 할당이 가능하다.

* 0 ~ 1023은 잘 알려진 포트이다. 사용하지 않는 것이 좋다.

  * FTP - 20, 21
  * TELNET - 23
  * HTTP - 80
  * HTTPS - 443

  

## DNS

> **도메인 네임 시스템**,  IP는 변경될 수 있기 때문에 도메인으로 IP주소를 변경하여 전화번호부같은 서버를 제공해준다.



### DNS 예시

| 도메인 명  | IP            |
| ---------- | ------------- |
| google.com | 123.354.323.2 |
| naver.com  | 124.555.333.2 |

1. 도메인 명으로 접속을 한다.
2. DNS서버에서는 도메인 명에 맞는 IP를 응답해준다.
3. 응답받은 IP로 서버에 접속한다.

