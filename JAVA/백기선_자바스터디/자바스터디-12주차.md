# 목표

자바의 애노테이션에 대해 학습하세요.

# 학습할 것 (필수)

- 애노테이션 정의하는 방법
- [@retention](https://github.com/retention)
- [@target](https://github.com/target)
- [@documented](https://github.com/documented)
- 애노테이션 프로세서



## 애노테이션이란

> 자바를 개발한 사람은 소스코드에 대한 문서를 만들기 보다, 소스 코드의 문서를 하나의 파일로 만드는 것이 더 낫다고 생각했다. 이로 인해 개발된 것이 JavaDoc - `/** ~ */`이다.  



* 이 기능을 응용하여 프로그램의 소스코드안에 다른 프로그램을 위한 정보를 미리 약속된 형식으로 포함시킨 것이 애노테이션이다.

* 애노테이션은 사전적으로 주석이라는 의미를 가지고 있으며, 프로그램에 대한 데이터를 제공하는 메타 데이터의 한 형태이다.



### 애노테이션의 용도

* 컴파일러에게 코드 작성 문법을 에러를 체크하고자, 에러 메세지를 억제하고자 사용
* 소프트웨어 개발툴의 빌드, 배치 시점에서 자동으로 코드를 생성하도록 사용
* 런타임 시점에서 특정 기능을 실행할 수 있도록 사용(Java Reflection)



## 애노테이션 정의하는 방법

```java
public @interface 애노테이션 이름 {
	타입 요소이름();
    ...
}
```

`@interface` 를 사용하여 애노테이션 타입을 선언한다. 



### 애노테이션의 요소

> 애노테이션 내에 선언된 메서드를 `애노테이션의 요소`라고 한다.
>
> *  애노테이션의 요소는 반환값이 있고, 매개변수는 없는 추상메서드의 형태를 가진다.
> * 상속을 통해 구현하지 않아도 된다. 하지만 적용시 요소들의 값을 빠짐없이 적어야한다(순서는 상관하지 않는다.)
> * 예외를 선언할 수 없다.
> * default값을 지정할 수 있다. `int count() default 3`
> * 요소를 타입 매개변수(지네릭)로 정의할 수 없다.
> * 요소의 타입은 int, String, enum, 애노테이션, Class만 가질 수 있다.
> * 요소는 배열로 여러개를 가질 수 있으며, 만약 요소가 하나라면 요소명은 제외하고 값만 적어도 된다.(배열이여도 요소명이 value면 값만 적을 수 있다.)



아래 예제를 보며 요소의 특징을 활용한다.

* myAnnotation

```java
public @interface TestCheck {
    int count();	// Primitive Type 원시형
   	String testedBy();	// String
    String[] testTools();	// 배열
    TestType testType; // enum TestType { FIRST, SECOND }
    DateTime testTime(); // 자신이 아닌 애노테이션을(@DateTime) 포함시킬 수 있다.
}

// 애노테이션 적용 예시

@TestCheck(
	count = 3, testedBy = "seunghan",
    testTools = {"JUnit", "AutoTester"},
    testType = TestType.FIRST,
    testTime = @DateTime(yyyymmdd = "220202", hhmmss = "001234")
)
public class TestClass {
    ...
}
```





## @Retention

애너테이션이 유지되는 기간을 지정하는데사용된다. 애너테이션의 유지 정책의 종류는 다음과 같다.

| 유지 정책 | 의미                                                |
| --------- | --------------------------------------------------- |
| SORUCE    | 소스 파일에만 존재. 클래스파일에는 존재하지 않는다. |
| CLASS     | 클래스 파일에 존재. 실행시에 사용불가. 기본값       |
| RUNTIME   | 클래스 파일에 존재. 실행시에 사용가능               |

* SOURCE - @Override, @SuppressWarnings처럼 컴파일러가 사용하는 애너테이션은 SOURCE 정책을 사용한다. 컴파일러를 직접 작성할 것이 아니라면 이 유지정책은 필요없다.
* CLASS - 컴파일러가 애너테이션의 정보를 클래스 파일에 저장할 수 있게는 하지만 JVM에 로딩될 떄는 애너테이션 정보가 무시되어 실행시 정보를 얻을 수 없다. 그래서 기본값임에도 잘 사용되지 않는다
* RUNTIME - 실행시 리플렉션(reflection)을 통해 클래스 파일에 저장된 애너테이션의 정보를 읽어서 처리할 수 있다. 



## @Target

애너테이션이 적용가능한 대상을 지정하는데 사용된다. 여러 개의 값을 지정할 때는 배열처럼 `{}`을 사용한다.

* @Target

```java
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.ANNOTATION_TYPE)
public @interface Target {
    /**
     * Returns an array of the kinds of elements an annotation type
     * can be applied to.
     * @return an array of the kinds of elements an annotation type
     * can be applied to
     */
    ElementType[] value();
}
```

ElementType을 배열로 적용가능한 대상으로 여러값을 줄 수 있다.

```java
@Target(ElmentType.FIELD, ElementType.METHOD, ElementType.TYPE)
```

#### ElementType 종류

| 대상 타입       | 의미                           |
| --------------- | ------------------------------ |
| ANNOTATION_TYPE | 애너테이션                     |
| CONSTRUCTOR     | 생성자                         |
| FIELD           | 필드(멤버변수, enum 상수)      |
| LOCAL_VARIABLE  | 지역변수                       |
| METHOD          | 메서드                         |
| PACKAGE         | 패키지                         |
| PARAMETER       | 매개변수                       |
| TYPE            | 타입(클래스, 인터페이스, enum) |
| TYPE_PARAMETER  | 타입 매개변수(JDK1.8)          |
| TYPE_USE        | 타입이 사용되는 모든 곳        |



## @Documented

애너테이션에 대한 정보가 javadoc으로 작성한 문서에 포함되도록 한다. 자바에서 제공하는 기본 애너테이션 중 `@Override`, `@SuppressWarnings`을 제외한 모두 이 메타 애너테이션이 붙어있다(`@Documented`본인까지도).

```java
package java.lang.annotation;

/**
 * Indicates that annotations with a type are to be documented by javadoc
 * and similar tools by default.  This type should be used to annotate the
 * declarations of types whose annotations affect the use of annotated
 * elements by their clients.  If a type declaration is annotated with
 * Documented, its annotations become part of the public API
 * of the annotated elements.
 *
 * @author  Joshua Bloch
 * @since 1.5
 */
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.ANNOTATION_TYPE)
public @interface Documented {
}
```



## 애노테이션 프로세서

### 애노테이션 프로세서란?

> 자바 컴파일러 플러그인의 일종으로 애노테이션에 대한 코드베이스를 검사, 수정, 생성하는 역할을 가진다.
