# 빈 스코프

> 출처 : 스프링 핵심 원리 - 기본편



## 빈 스코프란

스프링 빈이 스프링 컨테이너의 시작과 함께 생성되어서 스프링 컨테이너가 종료될 때까지 유지된다고 학습했다. 이것은 *스프링 빈이 기본적으로 싱글톤 스코프로 생성되기 때문이다.*

스코프는 빈이 존재할 수 있는 범위를 뜻한다.



### 스프링이 지원하는 스코프

- `싱글톤` - 기본 스코프, 스프링 컨테이너의 시작과 종료까지 유지되는 가장 넓은 범위의 스코프이다
- `프로토타입` - 스프링 컨테이너는 프로토타입 빈의 생성과 
- `웹 관련 스코프` 
  - request - 웹 요청이 들어오고 나갈 때까지 유지되는 스코프
  - session - 웹 세션이 생성되고 종료될 때까지 유지되는 스코프 
  - application - 웹의 서블릿 컨텍스트와 같은 범위로 유지되는 스코프



### 빈 스코프 지정 방법

- 컴포넌트 스캔 자동 등록

```java
@Scope("prototype")
@Component
public class HelloBean {
    ...
}
```

- 수동 등록

```java
@Scope("prototype")
@Bean
PrototypeBean HelloBean() {
    return new HelloBean();
}
```



## 프로토 타입 스코프

싱글톤 스코프의 빈을 조회하면 스프링 컨테이너는 항상 같은 인스턴스의 스프링 빈을 반환한다. 하지만 프로토타입 스코프를 스프링 컨테이너에 조회하면 각기 다른 인스턴스를 생성해서 반환한다.

- 싱글톤 빈 요청

![스크린샷 2022-08-10 00.14.42](https://tva1.sinaimg.cn/large/e6c9d24egy1h50x70beprj212w0koabu.jpg)

1. 싱글톤 스코프의 빈을 스프링 컨테이너에 요청
2. 스프링 컨테이너는 본인이 관리하는 스프링 빈을 반환
3. 이후에 같은 요청이 들어와도 같은 객체 인스턴스인 스프링 빈을 반환

- 프로토타입 빈 요청 1

![스크린샷 2022-08-10 00.16.22](https://tva1.sinaimg.cn/large/e6c9d24egy1h50x8osshmj21320kuq4s.jpg)

1. 프로토타입 스코프의 빈을 스프링 컨테이너에 요청
1. 스프링 컨테이너는 이 시점에 프로토타입 빈을 생성하고 필요 의존관계를 주입함



- 프로토타입 빈 요청 2

![스크린샷 2022-08-10 00.17.23](https://tva1.sinaimg.cn/large/e6c9d24egy1h50x9rj2szj21340kuq4w.jpg)

3. 스프링 컨테이너는 생성한 프로토타입 빈을 클라이언트에게 반환
4. 이후에 스프링 컨테이너에 같은 요청이 오면 항상 새로운 프로토타입 빈을 생성해서 반환



> 스프링 컨테이너는 프로토 타입 빈의 생성, 의존관계 주입, 초기화까지만 처리한다. 소멸은 클라이언트가 직접 수행해야 한다(@PreDestroy같은 종료 메서드가 호출되지 않는다).

