## 0106 Spring_Boot_CRUD

* 오늘은 CRUD를 적용할 것이다.

  

## Transaction

* Transaction : 

  >  데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 모두 수행되어야 할 일련의 연산들을 의미한다.

  

* 성질

  * 성질 1. 원자성 (Atomicity)

    > 1. 트랜잭션이 모두 반영 되거나, 전혀 반영 되지 않아야 한다는 특징.
    > 2. 연산 도중 오류가 검출된다면 전혀 반영되지 않으며 연산은 항상 완벽해야 함.

  * 성질 2. 일관성(Consistency)

    > 1.  트랜잭션의 작업 처리 결과가 항상 일관성이 있어야 한다는 특징.
    > 2. DB의 고정요소는 바뀌지 않으며, 일관성 있는 DB의 상태로 변환한다.

  * 성질 3. 독립성(Isolation)

    > 1. 둘 이상의 트랜잭션이 동시에 실행되는 경우에 어떤 하나의 트랜잭션이 다른 트랜잭션의 연산에 침범할 수 없다는 특징

  * 성질 4. 지속성(Durability)

    > 1. 연산이 완료된 트랜잭션의 결과가 영구적으로 반영되어야 한다는 특징

    

* 특징

  * Commit

    > 하나의 트랜잭션에 대한 작업이 끝났을 때 해당 연산의 갱신이 완료되었음을 트랜잭션 관리자에게 알리는 연산.

  * RollBack

    > 트랜잭션 처리가 비정상적으로 종료되어 DB의 일관성을 깼을 때, 일부가 정상으로 처리되더라도 모든 연산을 취소하는 연산.



## JPA 영속성 Context

* 영속성 컨텍스트

  > 엔티티를 영구 저장하는 환경. App과 DB사이의 임시 저장소 같은 논리적 개념이다.
  >
  > JPA 핵심 내용은 비영속성이냐 영속성이냐로 갈린다.

* JPA에서 영속성이 유지된 상태란 ?

  > 트랜잭션 안에서 데이터베이스의 데이터를 가져올 때.



## 알게된 정보

* JPA의 업데이트 방식

  > JPA는 기본적으로 전체 필드를 업데이트 한다.
  >
  > Dirty Checking으로 생성된 쿼리는 기본적으로 전체 필드를 업데이트 한다.
  >
  > + 변경 부분만 수정하고 싶다면 `@DynamicUpdate`를 사용한다.

  

* h2-console

  > 1. application.properties에 + spring.h2.console.enabled=true를 작성한다.
  > 2. 현재 프로젝트의 H2를 관리할 수 있는 관리페이지가 열린다.

  

* JPA-Auditing

  > 1. 보통 Entity에는 최초 삽입시간, 최종 수정시간 등을 포함한다.
  > 2. 이를 매번 자바 8의 LocalDate로 반복적으로 작성하는 것은 매우 불편한 일.
  > 3. JPA-Auditing은 이를 해결한다. 
  > 4. `@EntityListeners(AuditingEntityListener.class)`를 통해 Auditing 적용
  > 5. `@MappedSuperClass`를 통해 해당 클래스를 상속받게 한다. 예제에는 <u>**생성시간(`@CreateDate`), 수정시간(`@LastModifiedDate`)**</u>의 칼럼이 있고, 상속받은 클래스들은 밑줄 친 칼럼을 상속받는다.



## Mustache ( Template Engine)

* JSP와 같이 html을 만들어주는 템플릿 엔진이다. 다양한 언어를 지원한다.

* 자바로 사용할 때는 서버 템플릿 엔진으로, JS로 사용할 떄는 클라이언트 템플릿 엔진으로 모두 사용할 수 있다. 

  

### 장점

1. 문법이 쉽다.
2. 로직 작성이 불가하여 View에만 집중된다. (각 레이어의 역할이 분명해진다.)
3. 하나의 문법으로 서버/클라이언트 템플릿을 사용할 수 있다.

